# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ k3s Server –Ω–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é VM

> **–≠—Ç–∞–ø:** 1.1 - Server Node Setup
> **–¶–µ–ª—å:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ k3s Server –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—É—é VM
> **–î–∞—Ç–∞:** 2025-10-24

---

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–ü–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è VM –∏–∑ Template –∏ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ cloud-init, –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å k3s Server.

**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:**
- ‚úÖ VM –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∞ –∏–∑ Template (`02-clone-vm-for-server.md`)
- ‚úÖ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (`ssh k3s-admin@10.246.10.50`)
- ‚úÖ –°–µ—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ cloud-init –æ—Ç—Ä–∞–±–æ—Ç–∞–ª —É—Å–ø–µ—à–Ω–æ

---

## üìã –ß—Ç–æ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ?

**k3s Server –≤–∫–ª—é—á–∞–µ—Ç:**
- **Kubernetes API Server** –Ω–∞ –ø–æ—Ä—Ç—É 6443
- **etcd** –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è)
- **kubelet** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ pods –Ω–∞ Server –Ω–æ–¥–µ
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
  - Traefik (Ingress Controller)
  - ServiceLB (Load Balancer)
  - Local-path (Storage)
  - CoreDNS (DNS)
  - Flannel (CNI)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Kubernetes –∫–ª–∞—Å—Ç–µ—Ä –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π!

---

## üîß –°–ø–æ—Å–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –°–ø–æ—Å–æ–± 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `install-k3s-server.sh`**

### –°–ø–æ—Å–æ–± 2: –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

**–í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—ã –ø–æ—à–∞–≥–æ–≤–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞**

---

## üöÄ –°–ø–æ—Å–æ–± 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VM

```bash
# –° –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Server VM
ssh k3s-admin@10.246.10.50

# –ï—Å–ª–∏ SSH –∫–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª—å
ssh k3s-admin@10.246.10.50
# –ü–∞—Ä–æ–ª—å: admin
```

### –®–∞–≥ 2: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ù–∞ Server VM —Å–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ URL
curl -o install-k3s-server.sh https://raw.githubusercontent.com/[–≤–∞—à-repo]/k3s-manual/main/scripts/install-k3s-server.sh

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ scp
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
# scp scripts/install-k3s-server.sh k3s-admin@10.246.10.50:~/

# –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
nano install-k3s-server.sh
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ scripts/install-k3s-server.sh
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ù–∞ Server VM —Å–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x install-k3s-server.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É (–ù–ï –ø–æ–¥ sudo!)
./install-k3s-server.sh
```

### –®–∞–≥ 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç 6 —ç—Ç–∞–ø–æ–≤:**

```
[1/6] –ü—Ä–æ–≤–µ—Ä–∫–∞ prerequisites...
‚úÖ sudo –ø—Ä–∞–≤–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å ens192 –Ω–∞–π–¥–µ–Ω
‚úÖ IP –∞–¥—Ä–µ—Å: 10.246.10.50
‚úÖ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
‚úÖ DNS —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
‚úÖ –ü–æ—Ä—Ç 6443 —Å–≤–æ–±–æ–¥–µ–Ω

[2/6] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ k3s server...
üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ k3s...
üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞...
‚öôÔ∏è  –°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–∞...

[3/6] –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ k3s...
‚è≥ k3s —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
‚úÖ k3s —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω
‚úÖ API Server –¥–æ—Å—Ç—É–ø–µ–Ω

[4/6] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ kubeconfig...
üìÅ –°–æ–∑–¥–∞–Ω–∏–µ ~/k3s-credentials/
üìÑ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ kubeconfig
‚úÖ kubectl –Ω–∞—Å—Ç—Ä–æ–µ–Ω

[5/6] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ node-token...
üîë node-token —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è Agent –Ω–æ–¥

[6/6] –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è...
‚úÖ –ù–æ–¥–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ Ready
‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–µ pods –∑–∞–ø—É—â–µ–Ω—ã
‚úÖ API Server –æ—Ç–≤–µ—á–∞–µ—Ç

üéâ k3s Server —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!
```

**–í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏: 3-5 –º–∏–Ω—É—Ç**

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
kubectl get nodes
# k3s-server-01   Ready   control-plane,master   2m   v1.30.x+k3s1

kubectl get pods -A
# –í—Å–µ pods –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å Running

curl -k https://10.246.10.50:6443/version
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å –≤–µ—Ä—Å–∏–µ–π Kubernetes
```

---

## üõ†Ô∏è –°–ø–æ—Å–æ–± 2: –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è)

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VM

```bash
ssh k3s-admin@10.246.10.50
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏
ip addr show ens192
ping 10.246.10.1
ping 8.8.8.8

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
df -h
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 2GB —Å–≤–æ–±–æ–¥–Ω–æ

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ø–æ—Ä—Ç 6443 —Å–≤–æ–±–æ–¥–µ–Ω
sudo netstat -tulpn | grep 6443
# –í—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç—ã–º
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ k3s –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
# –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ k3s Server
curl -sfL https://get.k3s.io | sh -s - server \
  --write-kubeconfig-mode 644 \
  --node-ip 10.246.10.50 \
  --flannel-iface ens192 \
  --node-name k3s-server-01
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
- `server` - —Ä–µ–∂–∏–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (Server vs Agent)
- `--write-kubeconfig-mode 644` - –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ kubeconfig (–±–µ–∑ sudo)
- `--node-ip 10.246.10.50` - IP –∞–¥—Ä–µ—Å –Ω–æ–¥—ã –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞
- `--flannel-iface ens192` - —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è Flannel CNI
- `--node-name k3s-server-01` - –∏–º—è –Ω–æ–¥—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status k3s
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: active (running)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ kubectl —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo k3s kubectl get nodes
# k3s-server-01   Ready   control-plane,master   1m

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö pods
sudo k3s kubectl get pods -A
# –í—Å–µ pods –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å Running
```

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ kubectl –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è credentials
mkdir -p ~/k3s-credentials
mkdir -p ~/.kube

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ kubeconfig
sudo cp /etc/rancher/k3s/k3s.yaml ~/k3s-credentials/kubeconfig.yaml
sudo cp /etc/rancher/k3s/k3s.yaml ~/.kube/config

# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞
sudo chown $(id -u):$(id -g) ~/k3s-credentials/kubeconfig.yaml
sudo chown $(id -u):$(id -g) ~/.kube/config

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ kubectl —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ sudo
kubectl get nodes
```

### –®–∞–≥ 6: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ node-token

```bash
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è Agent –Ω–æ–¥
sudo cat /var/lib/rancher/k3s/server/node-token > ~/k3s-credentials/node-token.txt

# –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
cat > ~/k3s-credentials/cluster-info.txt << EOF
# k3s Cluster Information
Server URL: https://10.246.10.50:6443
Node Token: $(cat ~/k3s-credentials/node-token.txt)
Node Name: k3s-server-01

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è Agent –Ω–æ–¥:
curl -sfL https://get.k3s.io | K3S_URL=https://10.246.10.50:6443 K3S_TOKEN=$(cat ~/k3s-credentials/node-token.txt) sh -
EOF
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

k3s Server —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ –µ—Å–ª–∏:

### –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ `sudo systemctl status k3s` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç active (running)
- ‚úÖ `kubectl get nodes` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 1 –Ω–æ–¥—É –≤ Ready
- ‚úÖ `kubectl get pods -A` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ pods Running
- ‚úÖ `curl -k https://10.246.10.50:6443/version` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON

### –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ `~/k3s-credentials/kubeconfig.yaml` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ `~/k3s-credentials/node-token.txt` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ `~/.kube/config` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è kubectl

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ CoreDNS pod Running
- ‚úÖ Traefik pod Running
- ‚úÖ Local-path provisioner Running
- ‚úÖ Flannel –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–∑–¥–∞–Ω

---

## üö® Troubleshooting —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É"

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞
ping 8.8.8.8
curl -I https://get.k3s.io

# –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å DNS –∏ gateway
cat /etc/netplan/*.yaml
sudo netplan apply
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–æ—Ä—Ç 6443 –∑–∞–Ω—è—Ç"

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞
sudo netstat -tulpn | grep 6443

# –†–µ—à–µ–Ω–∏–µ: –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç
sudo pkill -f k3s
```

### –ü—Ä–æ–±–ª–µ–º–∞: k3s service –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç

```bash
# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
sudo journalctl -u k3s -n 50

# –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
# 1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø–∞–º—è—Ç–∏ - —É–≤–µ–ª–∏—á–∏—Ç—å RAM VM
# 2. DNS –ø—Ä–æ–±–ª–µ–º—ã - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å /etc/resolv.conf
# 3. Firewall - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å ufw status
```

### –ü—Ä–æ–±–ª–µ–º–∞: kubectl –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ KUBECONFIG
echo $KUBECONFIG
ls -la ~/.kube/config

# –†–µ—à–µ–Ω–∏–µ
export KUBECONFIG=~/.kube/config
# –∏–ª–∏
sudo k3s kubectl get nodes
```

---

## üîÑ –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ k3s (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ k3s
sudo systemctl stop k3s

# –£–¥–∞–ª–µ–Ω–∏–µ k3s
/usr/local/bin/k3s-uninstall.sh

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
sudo rm -rf /var/lib/rancher/k3s/
sudo rm -rf /etc/rancher/k3s/

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–Ω–æ–≤–æ
curl -sfL https://get.k3s.io | sh -s - server \
  --write-kubeconfig-mode 644 \
  --node-ip 10.246.10.50 \
  --flannel-iface ens192 \
  --node-name k3s-server-01
```

---

## üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º?

### –§–∞–π–ª—ã k3s –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
/usr/local/bin/k3s                    # –ì–ª–∞–≤–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫
/usr/local/bin/kubectl -> k3s         # kubectl = symlink
/etc/systemd/system/k3s.service       # systemd —Å–µ—Ä–≤–∏—Å
/etc/rancher/k3s/k3s.yaml            # kubeconfig
/var/lib/rancher/k3s/server/          # –î–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ db/                               # etcd –±–∞–∑–∞
‚îú‚îÄ‚îÄ tls/                             # TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
‚îú‚îÄ‚îÄ manifests/                       # –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îî‚îÄ‚îÄ node-token                       # Token –¥–ª—è Agent –Ω–æ–¥
```

### –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

```bash
# –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è flannel –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
ip addr show flannel.1
# flannel.1: inet 10.42.0.0/32 scope global flannel.1
```

### –ü—Ä–æ—Ü–µ—Å—Å—ã

```bash
# k3s –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep k3s
# k3s server --write-kubeconfig-mode 644 --node-ip 10.246.10.50 ...
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ k3s Server –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫:

**–≠—Ç–∞–ø 4:** –ü–æ–ª—É—á–µ–Ω–∏–µ credentials ‚Üí `04-get-credentials.md`

**–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤:**
- Server URL: `https://10.246.10.50:6443`
- kubeconfig: `~/k3s-credentials/kubeconfig.yaml`
- node-token: `~/k3s-credentials/node-token.txt`

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-10-24
**AI-–∞–≥–µ–Ω—Ç:** Server Node Setup Specialist
**–î–ª—è:** k3s –Ω–∞ vSphere –ø—Ä–æ–µ–∫—Ç üöÄ

**–ò–∑–≤–∏–Ω–∏—Ç–µ –∑–∞ –ø—Ä–æ–ø—É—Å–∫ —ç—Ç–æ–≥–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–≥–æ —ç—Ç–∞–ø–∞!** üòî
