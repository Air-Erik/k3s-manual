# –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VM Template –¥–ª—è k3s

> **–≠—Ç–∞–ø:** 0 - VM Template Preparation
> **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** AI-–∞–≥–µ–Ω—Ç + –û–ø–µ—Ä–∞—Ç–æ—Ä
> **–°—Ç–∞—Ç—É—Å:** üöÄ –í —Ä–∞–±–æ—Ç–µ
> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-24

---

## üìã –ö–æ–Ω—Ç–µ–∫—Å—Ç

–¢—ã AI-–∞–≥–µ–Ω—Ç, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º **k3s –Ω–∞ VMware vSphere —Å NSX-T**.

### –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ:
- ‚úÖ **NSX-T –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** Segment `k8s-zeon-dev-segment` (10.246.10.0/24)
- ‚úÖ **T1 Gateway:** `T1-k8s-zeon-dev` —Å NAT –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ **IP-–ø–ª–∞–Ω:** 10.246.10.50 (Server), 10.246.10.51-52 (Agents)
- ‚úÖ **vSphere:** v8.0.3, –¥–æ—Å—Ç—É–ø –∫ vCenter –µ—Å—Ç—å
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** –ü–æ–ª–Ω—ã–π –ø–ª–∞–Ω –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ß—Ç–æ –ù–ï–¢ (—Ç–≤–æ—è –∑–∞–¥–∞—á–∞):
- ‚ùå **VM Template –¥–ª—è k3s** ‚Äî –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å –Ω—É–ª—è!

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å **minimal VM Template** –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è k3s –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–∞ VMware vSphere.

### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –û—Ç–ª–∏—á–∏–µ –æ—Ç Kubernetes Template

**–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–¥—Ö–æ–¥ –∏–∑ "–ø–æ–ª–Ω–æ–≥–æ" Kubernetes –ø—Ä–æ–µ–∫—Ç–∞!**

‚ùå **k8s Template —Å–æ–¥–µ—Ä–∂–∞–ª:**
- kubeadm, kubelet, kubectl (–ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
- containerd (–Ω–∞—Å—Ç—Ä–æ–µ–Ω –∑–∞—Ä–∞–Ω–µ–µ)
- sysctl –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è K8s
- Swap –æ—Ç–∫–ª—é—á–µ–Ω
- –ú–æ–¥—É–ª–∏ —è–¥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã

‚úÖ **k3s Template –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**
- **–¢–û–õ–¨–ö–û** Ubuntu 24.04 LTS (minimal install)
- –ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã (curl, wget, vim, net-tools)
- Cloud-init –¥–ª—è –∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- open-vm-tools –¥–ª—è vSphere –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **–ë–ï–ó** kubeadm, kubelet, kubectl
- **–ë–ï–ó** containerd (k3s —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å–≤–æ–π –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π!)
- **–ë–ï–ó** K8s-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–ü–æ—á–µ–º—É:** k3s ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–≤–∫–ª—é—á–∞—è containerd). –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∞ K8s –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç **–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å** —Å k3s!

---

## üîß –¢–≤–æ—è —Ä–æ–ª—å –∫–∞–∫ AI-–∞–≥–µ–Ω—Ç–∞

–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ VM Template –¥–ª—è k3s. –¢–≤–æ—è –∑–∞–¥–∞—á–∞:

1. **–°–æ–∑–¥–∞—Ç—å –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é minimal Ubuntu VM –≤ vSphere
2. **–ù–∞–ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ VM** –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –≤ Template
3. **–°–æ–∑–¥–∞—Ç—å cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ k3s –Ω–æ–¥
4. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏** Template
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å troubleshooting** —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

**–í–∞–∂–Ω–æ:** –í—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é** –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π!

---

## üìä –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### vSphere Environment:
- **vSphere/vCenter:** v8.0.3
- **Datastore:** –õ—é–±–æ–π (–æ–ø–µ—Ä–∞—Ç–æ—Ä —Ä–∞–∑–º–µ—Å—Ç–∏—Ç –≥–¥–µ –Ω—É–∂–Ω–æ)
- **Network:** NSX-T Segment `k8s-zeon-dev-segment`

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ VM Template:
```yaml
Name: k3s-ubuntu2404-minimal-template
OS: Ubuntu 24.04 LTS Server (minimal)
vCPU: 2
RAM: 4 GB (–¥–ª—è Server node)
Disk: 40 GB (thin provisioned)
Network: 1 NIC (–±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ k8s-zeon-dev-segment)
```

### Network Configuration:
```yaml
DNS Server: 172.17.10.3
Gateway: 10.246.10.1
IP Range –¥–ª—è k3s –Ω–æ–¥: 10.246.10.50-60
Domain: –Ω–µ—Ç (–ø–æ–∫–∞)
```

### SSH Access:
```yaml
User: k8s-admin
Password: admin (–¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
SSH: –ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è VM
```

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ k3s –Ω–æ–¥—ã:
```yaml
Server Node:
  - IP: 10.246.10.50
  - Hostname: k3s-server-01
  - RAM: 4 GB, vCPU: 2

Agent Node 1:
  - IP: 10.246.10.51
  - Hostname: k3s-agent-01
  - RAM: 2 GB, vCPU: 2

Agent Node 2:
  - IP: 10.246.10.52
  - Hostname: k3s-agent-02
  - RAM: 2 GB, vCPU: 2
```

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–¥–∞–Ω–∏—è

–°–æ–∑–¥–∞–π —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ**, –æ–±—ä—è—Å–Ω—è—è –∫–∞–∂–¥—ã–π —à–∞–≥ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É.

### –≠—Ç–∞–ø 1: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ VM

**–°–æ–∑–¥–∞–π:** `research/vm-template-prep/01-vm-requirements.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –¢–æ—á–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ VM (vCPU, RAM, Disk)
- –°–ø–∏—Å–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –°–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Ubuntu

**–¶–µ–ª—å:** –û–ø–µ—Ä–∞—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–Ω–∏–º–∞—Ç—å —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤ vSphere.

---

### –≠—Ç–∞–ø 2: –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è VM

**–°–æ–∑–¥–∞–π:** `research/vm-template-prep/02-create-vm-in-vsphere.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è VM –≤ vSphere UI
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ VM (vCPU, RAM, Disk, Network)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ubuntu 24.04 LTS (minimal)
- –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –û–° –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VM

**–§–æ—Ä–º–∞—Ç:** –°–∫—Ä–∏–Ω—à–æ—Ç—ã –Ω–µ –Ω—É–∂–Ω—ã, –Ω–æ –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–∫–∞.

---

### –≠—Ç–∞–ø 3: –°–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ VM

**–°–æ–∑–¥–∞–π:** `scripts/prepare-vm-template.sh`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (apt update && apt upgrade)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (curl, wget, vim, net-tools, cloud-init, open-vm-tools)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cloud-init
- –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–ª–æ–≥–∏, history, SSH keys, machine-id)
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Template

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **idempotent** (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (set -e)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (echo —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º)
- –ü—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ VM Template –¥–ª—è k3s
# –î–∞—Ç–∞: 2025-10-24

set -e  # –í—ã—Ö–æ–¥ –ø—Ä–∏ –æ—à–∏–±–∫–µ

echo "=== –ù–∞—á–∞–ª–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ VM Template –¥–ª—è k3s ==="

# 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
echo "[1/6] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã..."
sudo apt update && sudo apt upgrade -y

# 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
echo "[2/6] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤..."
# ...

# –∏ —Ç.–¥.
```

---

### –≠—Ç–∞–ø 4: Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–°–æ–∑–¥–∞–π:** `manifests/cloud-init/`

–¢—Ä–∏ —Ñ–∞–π–ª–∞ cloud-init –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–¥—ã:

#### 4.1. `manifests/cloud-init/server-node.yaml`
Cloud-init –¥–ª—è Server –Ω–æ–¥—ã (10.246.10.50)

#### 4.2. `manifests/cloud-init/agent-node-01.yaml`
Cloud-init –¥–ª—è Agent –Ω–æ–¥—ã 1 (10.246.10.51)

#### 4.3. `manifests/cloud-init/agent-node-02.yaml`
Cloud-init –¥–ª—è Agent –Ω–æ–¥—ã 2 (10.246.10.52)

**–ö–∞–∂–¥—ã–π cloud-init –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**
```yaml
#cloud-config
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ [–Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–¥—ã]

hostname: [hostname]
fqdn: [hostname]

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
users:
  - name: k8s-admin
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    lock_passwd: false
    passwd: [—Ö—ç—à –ø–∞—Ä–æ–ª—è 'admin']

# –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP
write_files:
  - path: /etc/netplan/01-static-ip.yaml
    content: |
      network:
        version: 2
        ethernets:
          ens192:
            addresses: [IP/24]
            routes:
              - to: default
                via: 10.246.10.1
            nameservers:
              addresses: [172.17.10.3]

# –ö–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ boot
runcmd:
  - netplan apply
  - systemctl restart systemd-networkd
```

**–í–∞–∂–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `routes:` –≤–º–µ—Å—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ `gateway4:`
- –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö—ç—à–∏—Ä–æ–≤–∞–Ω (`mkpasswd --method=SHA-512`)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML

---

### –≠—Ç–∞–ø 5: –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Template

**–°–æ–∑–¥–∞–π:** `research/vm-template-prep/03-convert-to-template.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π
- –ö–æ–º–∞–Ω–¥—ã –æ—á–∏—Å—Ç–∫–∏ (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç)
- –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ VM ‚Üí Template –≤ vSphere UI
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ Template —Å–æ–∑–¥–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –≠—Ç–∞–ø 6: –í–∞–ª–∏–¥–∞—Ü–∏—è Template

**–°–æ–∑–¥–∞–π:** `research/vm-template-prep/04-template-validation.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π VM –∏–∑ Template
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
  - Cloud-init –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP –Ω–∞—Å—Ç—Ä–æ–µ–Ω
  - DNS —Ä–∞–±–æ—Ç–∞–µ—Ç
  - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
  - SSH –¥–æ—Å—Ç—É–ø —Ä–∞–±–æ—Ç–∞–µ—Ç
  - Hostname —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ö–æ–º–∞–Ω–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–ø—Ä–∏–º–µ—Ä—ã):**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ IP
ip addr show ens192

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
ip route

# –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS
cat /etc/resolv.conf
nslookup google.com

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
ping -c 3 8.8.8.8

# –ü—Ä–æ–≤–µ—Ä–∫–∞ cloud-init
cloud-init status
cat /var/log/cloud-init.log
```

---

### –≠—Ç–∞–ø 7: Troubleshooting Guide

**–°–æ–∑–¥–∞–π:** `research/vm-template-prep/05-troubleshooting.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Template
- –†–µ—à–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã
- –ö–æ–º–∞–Ω–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º:**
1. Cloud-init –Ω–µ –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
2. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
3. DNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. SSH –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
5. Machine-id –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π

---

## üì¶ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞ –≤—ã—Ö–æ–¥–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã:

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [x] `research/vm-template-prep/01-vm-requirements.md`
- [x] `research/vm-template-prep/02-create-vm-in-vsphere.md`
- [x] `research/vm-template-prep/03-convert-to-template.md`
- [x] `research/vm-template-prep/04-template-validation.md`
- [x] `research/vm-template-prep/05-troubleshooting.md`

### –°–∫—Ä–∏–ø—Ç—ã:
- [x] `scripts/prepare-vm-template.sh` ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VM –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- [x] `manifests/cloud-init/server-node.yaml` ‚Äî –¥–ª—è 10.246.10.50
- [x] `manifests/cloud-init/agent-node-01.yaml` ‚Äî –¥–ª—è 10.246.10.51
- [x] `manifests/cloud-init/agent-node-02.yaml` ‚Äî –¥–ª—è 10.246.10.52

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–ó–∞–¥–∞–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∫–æ–≥–¥–∞:

1. **–í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ–∑–¥–∞–Ω—ã** –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
2. **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–Ω—è—Ç–Ω—ã** –æ–ø–µ—Ä–∞—Ç–æ—Ä—É –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–≥—Ä–∞—É–Ω–¥–∞
3. **–°–∫—Ä–∏–ø—Ç—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é** –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. **Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∞–ª–∏–¥–Ω—ã** (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π YAML)
5. **Troubleshooting guide –ø–æ–∫—Ä—ã–≤–∞–µ—Ç** –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞ (–≤—ã–ø–æ–ª–Ω–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä):**
- [ ] Minimal Ubuntu VM —Å–æ–∑–¥–∞–Ω–∞ –≤ vSphere
- [ ] –°–∫—Ä–∏–ø—Ç `prepare-vm-template.sh` —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] VM –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ Template: `k3s-ubuntu2404-minimal-template`
- [ ] –¢–µ—Å—Ç–æ–≤–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ
- [ ] Cloud-init –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (static IP, hostname, DNS)
- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π VM —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üéØ –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º

### –î–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞:

**–®–∞–≥ 1:** –ü—Ä–∏–∫—Ä–µ–ø–∏ –∫ AI-–∞–≥–µ–Ω—Ç—É —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:
- `README.md` ‚Äî –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
- `nsx-configs/segments.md` ‚Äî —Å–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `research/vm-template-prep/AI-AGENT-TASK.md` ‚Äî —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ

**–®–∞–≥ 2:** –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ–º–ø—Ç:
```
–ü—Ä–∏–≤–µ—Ç! –¢—ã AI-–∞–≥–µ–Ω—Ç, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º k3s –Ω–∞ vSphere.

–Ø –ø—Ä–∏–∫—Ä–µ–ø–∏–ª:
1. README.md ‚Äî –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
2. nsx-configs/segments.md ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏
3. AI-AGENT-TASK.md ‚Äî —Ç–≤–æ—è –∑–∞–¥–∞—á–∞

–¢–≤–æ—è –∑–∞–¥–∞—á–∞: –°–æ–∑–¥–∞—Ç—å minimal VM Template –¥–ª—è k3s –∫–ª–∞—Å—Ç–µ—Ä–∞.

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –≠—Ç–æ –ù–ï –æ–±—ã—á–Ω—ã–π Kubernetes Template!
k3s ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.
–ù–ï –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å kubeadm, kubelet, kubectl, containerd!

–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- vSphere: 8.0.3
- Network: k8s-zeon-dev-segment (10.246.10.0/24)
- DNS: 172.17.10.3
- Gateway: 10.246.10.1
- SSH: k8s-admin:admin

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞:
1. –ü—Ä–æ—á–∏—Ç–∞–π AI-AGENT-TASK.md –ø–æ–ª–Ω–æ—Å—Ç—å—é
2. –°–æ–∑–¥–∞–≤–∞–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–≠—Ç–∞–ø—ã 1-7)
3. –û–±—ä—è—Å–Ω—è–π –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ
4. –ü–∏—à–∏ –≥–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç—ã

–ù–∞—á–Ω—ë–º —Å –≠—Ç–∞–ø–∞ 1: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ VM.
–ì–æ—Ç–æ–≤?
```

**–®–∞–≥ 3:** –†–∞–±–æ—Ç–∞–π —Å AI-–∞–≥–µ–Ω—Ç–æ–º –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ:
- AI —Å–æ–∑–¥–∞—ë—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
- –¢—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ü–µ—Ä–µ—Ö–æ–¥–∏—à—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É

**–®–∞–≥ 4:** –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤:
- –ü—Ä–∏–º–µ–Ω—è–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ vSphere
- –í—ã–ø–æ–ª–Ω—è–π –≤–∞–ª–∏–¥–∞—Ü–∏—é
- –°–æ–æ–±—â–∏ Team Lead –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [Ubuntu 24.04 Cloud Images](https://cloud-images.ubuntu.com/releases/24.04/)
- [Cloud-init Documentation](https://cloudinit.readthedocs.io/)
- [k3s Documentation](https://docs.k3s.io/)
- [VMware Cloud-Init](https://docs.vmware.com/en/VMware-vSphere/8.0/vsphere-vm-administration/GUID-E63B6FAA-8D35-428D-B40C-744769845906.html)

**–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:**
- Ubuntu 24.04 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Netplan v2** –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –í Netplan v2: `gateway4:` **deprecated**, –∏—Å–ø–æ–ª—å–∑—É–π `routes:` + `via:`
- Cloud-init –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ `/etc/cloud/cloud.cfg.d/`
- vSphere —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç cloud-init —á–µ—Ä–µ–∑ `guestinfo.*` properties

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

| –≠—Ç–∞–ø | AI —Å–æ–∑–¥–∞–Ω–∏–µ | –û–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –ò—Ç–æ–≥–æ |
|------|-------------|---------------------|-------|
| –≠—Ç–∞–ø—ã 1-7 (–¥–æ–∫—É–º–µ–Ω—Ç—ã + —Å–∫—Ä–∏–ø—Ç—ã) | 20 –º–∏–Ω | - | 20 –º–∏–Ω |
| –°–æ–∑–¥–∞–Ω–∏–µ VM –≤ vSphere | - | 10 –º–∏–Ω | 10 –º–∏–Ω |
| –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ | - | 5 –º–∏–Ω | 5 –º–∏–Ω |
| –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Template | - | 2 –º–∏–Ω | 2 –º–∏–Ω |
| –í–∞–ª–∏–¥–∞—Ü–∏—è (–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø—Ä–æ–≤–µ—Ä–∫–∏) | - | 8 –º–∏–Ω | 8 –º–∏–Ω |
| **–ò–¢–û–ì–û** | **20 –º–∏–Ω** | **25 –º–∏–Ω** | **~45 –º–∏–Ω** |

---

## üéâ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Team Lead, —É–±–µ–¥–∏—Å—å —á—Ç–æ:

- ‚úÖ –í—Å–µ 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –°–∫—Ä–∏–ø—Ç `prepare-vm-template.sh` –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ 3 cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã –∏ –≤–∞–ª–∏–¥–Ω—ã
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–Ω—è—Ç–Ω—ã –∏ –¥–µ—Ç–∞–ª—å–Ω—ã
- ‚úÖ Troubleshooting guide –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ VM Template —Å–æ–∑–¥–∞–Ω –≤ vSphere: `k3s-ubuntu2404-minimal-template`
- ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ

---

**–£–¥–∞—á–∏, AI-–∞–≥–µ–Ω—Ç! –°–æ–∑–¥–∞–≤–∞–π –æ—Ç–ª–∏—á–Ω—ã–π minimal VM Template –¥–ª—è k3s! üöÄ**

**Team Lead –∂–¥—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –≠—Ç–∞–ø—É 1 (k3s Server installation).**
